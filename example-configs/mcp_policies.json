{
  "version": "1.0",
  "name": "powersearch-generated-policy",
  "description": "Generated policy for MCP server: powersearch",
  "rules": [
    {
      "name": "list-tools",
      "description": "List all tools (tip: exclude from `attributes.name`'s values the ones that you want to hide from the MCP client)",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:read"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "tools"
        },
        {
          "path": "attributes.name",
          "operator": "in",
          "value": [
            "search",
            "fetch_url"
          ]
        }
      ],
      "actions": [
        "list"
      ]
    },
    {
      "name": "execute-tools-search",
      "description": "Execute tools:search (tip: add additional conditions on `attributes.arguments.[:path]` to restrict this execution)",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:read"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "tools"
        },
        {
          "path": "attributes.name",
          "operator": "equals",
          "value": "search"
        }
      ],
      "actions": [
        "execute"
      ]
    },
    {
      "name": "execute-tools-fetch_url",
      "description": "Execute tools:fetch_url (tip: add additional conditions on `attributes.arguments.[:path]` to restrict this execution)",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:read"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "tools"
        },
        {
          "path": "attributes.name",
          "operator": "equals",
          "value": "fetch_url"
        }
      ],
      "actions": [
        "execute"
      ]
    },
    {
      "name": "list-prompts",
      "description": "List all prompts (tip: exclude from `attributes.name`'s values the ones that you want to hide from the MCP client)",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:read"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "prompts"
        },
        {
          "path": "attributes.name",
          "operator": "in",
          "value": [
            "internet_search_prompt"
          ]
        }
      ],
      "actions": [
        "list"
      ]
    },
    {
      "name": "execute-prompts-internet_search_prompt",
      "description": "Execute prompts:internet_search_prompt (tip: add additional conditions on `attributes.arguments.[:path]` to restrict this execution)",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:read"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "prompts"
        },
        {
          "path": "attributes.name",
          "operator": "equals",
          "value": "internet_search_prompt"
        }
      ],
      "actions": [
        "execute"
      ]
    }
  ],
  "default_effect": "deny"
}
