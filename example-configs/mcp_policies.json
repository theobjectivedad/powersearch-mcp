{
  "version": "1.0",
  "name": "powersearch-default-policy",
  "description": "Default Eunomia policy for PowerSearch MCP. Requires powersearch:read to list tools/prompts and powersearch:execute to call tools.",
  "rules": [
    {
      "name": "list-powersearch-tools",
      "description": "Allow clients with powersearch:read to list exposed tools.",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:read"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "tools"
        },
        {
          "path": "attributes.name",
          "operator": "in",
          "value": [
            "search",
            "fetch_url"
          ]
        }
      ],
      "actions": [
        "list"
      ]
    },
    {
      "name": "execute-powersearch-search",
      "description": "Allow clients with powersearch:execute to call the search tool.",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:execute"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "tools"
        },
        {
          "path": "attributes.name",
          "operator": "equals",
          "value": "search"
        }
      ],
      "actions": [
        "execute"
      ]
    },
    {
      "name": "execute-powersearch-fetch-url",
      "description": "Allow clients with powersearch:execute to call the fetch_url tool.",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:execute"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "tools"
        },
        {
          "path": "attributes.name",
          "operator": "equals",
          "value": "fetch_url"
        }
      ],
      "actions": [
        "execute"
      ]
    },
    {
      "name": "list-powersearch-prompts",
      "description": "Allow clients with powersearch:read to list exposed prompts.",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:read"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "prompts"
        },
        {
          "path": "attributes.name",
          "operator": "in",
          "value": [
            "internet_search_prompt"
          ]
        }
      ],
      "actions": [
        "list"
      ]
    },
    {
      "name": "execute-powersearch-internet-search-prompt",
      "description": "Allow clients with powersearch:read to call the internet_search_prompt prompt.",
      "effect": "allow",
      "principal_conditions": [
        {
          "path": "claims.scope",
          "operator": "contains",
          "value": "powersearch:read"
        }
      ],
      "resource_conditions": [
        {
          "path": "attributes.component_type",
          "operator": "equals",
          "value": "prompts"
        },
        {
          "path": "attributes.name",
          "operator": "equals",
          "value": "internet_search_prompt"
        }
      ],
      "actions": [
        "execute"
      ]
    }
  ],
  "default_effect": "deny"
}
